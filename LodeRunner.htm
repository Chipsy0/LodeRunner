<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lode Runner par Caroline Chagnon et Razvan Pruteanu</title>
    <link rel="stylesheet" type="text/css" href="StyleProjet1.css" />
    <!-- Code JavaScript local -->
    <script type="text/javascript">
        var objCanvas = null;
        var objC2D = null;
        var objCycleAnimation = null;

        var tabTableau = null;
        var tabObjets = null;

        function initAnimation() {
            objCanvas = document.getElementById('monCanvas');
            objCanvas.focus();
            objC2D = objCanvas.getContext('2d');
            tabObjets = new Array(17);
            for (var i = 0; i < tabObjets.length; i++){
                tabObjets[i] = new Array(25);
            }
            //initPasserelles();
            //initMurs();
            //initBarres();
            initTableau();
            //initSons();
            //initPointage();
            //initTrajetBalle();
            dessiner(); // Dessiner une première fois
            //animer();  // animer
        }

        // Construire les passerelles
        function initPasserelles(intX,intY) {
            var objPasserelle = new Object();
            objPasserelle.strCouleur = 'red';
            objPasserelle.intLargeur = 30;
            objPasserelle.intHauteur = 30;
            objPasserelle.intX = intX;
            objPasserelle.intY = intY;
            tabObjets[intX][intY] = objPasserelle;
        }

        // Construire les murs
        function initMurs() {
            var objMur = null;
            var objImageMurs = new Image();
            objImageMurs.src = 'murs.jpg';

            // Le mur de gauche (#0)
            objMur = new Object();
            objMur.intXDebut = 0;
            objMur.intYDebut = 0;
            objMur.intXFin = Math.floor(objCanvas.width / 60);
            objMur.intYFin = objCanvas.height
            objMur.strCouleur = 'midnightblue';
            objMur.objImage = objImageMurs;
            tabObjMurs.push(objMur);

            // Le mur du centre (en haut) (#1)
            objMur = new Object();
            objMur.intXDebut = 0;
            objMur.intYDebut = 0;
            objMur.intXFin = objCanvas.width;
            objMur.intYFin = Math.floor(objCanvas.width / 60);
            objMur.strCouleur = 'midnightblue';
            objMur.objImage = objImageMurs;
            tabObjMurs.push(objMur);

            // Le mur de droite (#2)
            objMur = new Object();
            objMur.intXDebut = objCanvas.width;
            objMur.intYDebut = 0;
            objMur.intXFin = objCanvas.width - Math.floor(objCanvas.width / 60);
            objMur.intYFin = objCanvas.height;
            objMur.strCouleur = 'midnightblue';
            objMur.objImage = objImageMurs;
            tabObjMurs.push(objMur);
        }

        // Construire le bâton
        function initBarres() {
            var objImageBaton = new Image();
            objImageBaton.src = 'baton.png';
            objBaton = new Object();
            objBaton.objImage = objImageBaton;
            objBaton.intLargeur = Math.floor(objCanvas.width / 10);
            objBaton.intHauteur = Math.floor(objCanvas.height / 20);
            objBaton.intX = (objCanvas.width - objBaton.intLargeur) / 2;
            objBaton.intY = objCanvas.height - Math.floor(objCanvas.height / 5);
            objBaton.intVitesse = Math.floor(objCanvas.width / 30);
            objBaton.intDirection = 1;
        }

        // Construire la balle

        function initTableau() {

            tabTableau = new Array();
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            tabTableau.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);

            for (var i = 0; i < tabTableau.length; i++) {
                for (var j = 0; j < tabTableau[i].length; j++) {
                    switch (tabTableau[i][j]) {
                        case 1:
                            initPasserelles(j,i);
                            break;
                    }
                }
            }
        }

        // Construire les sons
        function initSons() {
            objSons = new Object();

            var objSon = document.createElement('audio');
            objSon.setAttribute('src', 'SonBalleMur.mp3');
            objSon.load();
            objSons.balleMur = objSon;

            objSon = document.createElement('audio');
            objSon.setAttribute('src', 'SonBallePerdue.mp3');
            objSon.load();
            objSons.ballePerdue = objSon;

            objSon = document.createElement('audio');
            objSon.setAttribute('src', 'SonDisparitionVortex.mp3');
            objSon.load();
            objSons.disparitionVortex = objSon;

            objSon = document.createElement('audio');
            objSon.setAttribute('src', 'SonBalleBaton.mp3');
            objSon.load();
            objSons.balleBaton = objSon;
        }

        // Construire les cartes de pointage
        function initPointage() {
            objPointage = new Object();
            objPointage.intX = tabObjMurs[0].intXFin + 4;
            objPointage.intY = objBaton.intY + objBaton.intHauteur + 4;
            objPointage.intLargeur = tabObjMurs[2].intXFin - objPointage.intX;
            objPointage.intHauteur = objCanvas.height - objPointage.intY - 4;

            objPointage.intNbBallesRestantes = 15;
            objPointage.intNbBallesPerdues = 0;
            objPointage.intNbBallesVortex = 0;

            var objImage = new Image();
            objImage.src = 'balle.jpg';
            objPointage.objImageBalle = objImage;

            objImage = new Image();
            objImage.src = 'vortex.jpg';
            objPointage.objImageVortex = objImage;

            objImage = new Image();
            objImage.src = 'Perdu.jpg';
            objPointage.objImagePerdu = objImage;
        }

        function initTrajetBalle() {

            objTrajetBalle = new Object();
            objTrajetBalle.tabPositions = new Array();
            objTrajetBalle.couleur = 'lightgreen';
        }

        // Un cycle d'animation	
        function animer() {
            // Requête pour le prochain cycle
            objCycleAnimation = requestAnimationFrame(animer);

            // Le cycle d'animation
            effacerDessin();
            mettreAjourAnimation();
            dessiner();
        }

        // Arrêter l'animation
        function arreterAnimation() {
            if (objCycleAnimation != null)
                cancelAnimationFrame(objCycleAnimation);
            objCycleAnimation = null;
        }

        // Pour effacer le dessin
        function effacerDessin() {
            objC2D.clearRect(0, 0, objCanvas.width, objCanvas.height);
        }

        // Pour mettre à jour l'animation
        function mettreAjourAnimation() {

        }


        // Pour dessiner le tableau
        function dessiner() {
            
            
            for (var i = 0; i < tabTableau.length; i++) {
                for (var j = 0; j < tabTableau[i].length; j++) {
                    switch (tabTableau[i][j]) {
                        case 1:
                            dessinerPasserelles(j,i);
                            break;
                    }
                }
            }
        }

        // Pour dessiner l'image de fond
        function dessinerPasserelles(intX,intY) {
            objC2D.save();
            var objPasserelle = tabObjets[intX][intY];
            intPosX = objPasserelle.intX * 30;
            intPosY = objPasserelle.intY * 30;
            objC2D.fillStyle = objPasserelle.strCouleur;
            objC2D.fillRect(intPosX,intPosY,objPasserelle.intLargeur,objPasserelle.intHauteur);
            objC2D.restore();
        }

    </script>
</head>

<body onload="initAnimation()">
    <canvas id="monCanvas" width="750" height="510" tabIndex="1" class="sCanvas">
        Votre navigateur ne supporte pas la balise canvas
    </canvas>
</body>

</html>